《Let's Get Dirty: GAN Based Data Augmentation for Soiling and Adverse Weather Classification in Autonomous Driving》    
DirtyGAN：自动驾驶中**基于GAN的数据增广**技术用于广角鱼眼镜头污染检测和不利天气分类，是一个基于生成对抗网络（GAN）的算法，旨在解决自动驾驶中相机镜头污染的问题。   
https://github.com/valeoai/woodscape    
我们提出了一种新颖的基于 GAN 的算法，用于生成看似被污染的图像（以扩充数据集，使得模型能够更好地检测污染）。此外，该方法还自动提供相应的污染掩码，从而消除了手动注释的成本。   

## 问题背景：    
在自动驾驶中，广角鱼眼相机常用于停车和低速导航任务。这些相机直接暴露在恶劣的环境条件下，容易被泥浆、灰尘、水和霜冻污染。
相机镜头上的污渍会严重降低视觉感知算法的性能，因此越来越多地部署了由污染检测算法触发的相机清洁系统。  

## DirtyGAN的组成：     
生成对抗网络（GAN）：DirtyGAN使用GAN模型，其中包括生成器和判别器。   
+ 生成器：生成器负责生成看似被污染的图像。它学习从干净图像到污染图像的映射。   
+ 判别器：判别器用于区分真实污染图像和生成的污染图像。     

### 它通过以下步骤实现：
+ 使用干净图像作为输入，生成器生成看似被污染的图像。   
+ 生成器还自动提供相应的污染掩码，消除了手动注释的成本。   
+ 生成的污染图像用于训练，从而显著提高了污染检测任务的准确性。    

### 实验验证：   
DirtyGAN的作者使用了手动注释的污染数据集和生成的增强数据集。他们还展示了在Cityscapes数据集上使用鱼眼训练的DirtyGAN模型的泛化能力。此外，他们评估了污染数据对语义分割算法性能的影响。    

## 生成器（Generator）：    
生成器是DirtyGAN的核心部分，负责生成看似被污染的图像。

## 生成器的组成部分：
+ 输入：    
  生成器接收一个输入，通常是干净的图像（没有污染）。这个输入图像将被转换为看似被污染的版本。    
+ 卷积神经网络（CNN）：   
  生成器通常使用卷积神经网络（CNN）来处理图像。CNN具有多个卷积层和池化层，用于学习图像的特征。
+ 污染生成：     
  生成器的目标是生成具有类似污染的纹理、斑点或瑕疵的图像。它通过学习从干净图像到污染图像的映射来实现这一目标。
+ 噪声注入：     
  生成器可能会添加一些随机噪声，以增加图像的真实感。这有助于使生成的图像看起来更自然，更类似于实际被污染的图像。
+ 输出：   
  生成器的输出是一个看似被污染的图像，可以用于训练污染检测算法。

## 判别器：     
判别器在GAN中的作用类似于一个分类器。它的任务是`区分真实数据（例如干净的图像）和生成器生成的数据（看似被污染的图像）`。

## 判别器的工作原理：     
+ 判别器接收输入数据，并尝试判断它是真实数据还是生成的数据。它可以使用适合于所分类数据类型的任何网络架构。   
+ 判别器的训练：          
  在训练过程中，判别器首先学会区分明显的假数据。    
  随着训练的进行，生成器逐渐生成更接近真实数据的输出。    
  如果生成器训练良好，判别器开始难以区分真实数据和生成的数据，其准确性下降。     

## 判别器和生成器的关系：     
生成器和判别器都是神经网络。生成器的输出直接连接到判别器的输入。通过反向传播，判别器的分类结果提供信号，生成器根据这些信号更新权重。

污染生成的pipeline的核心是由 CycleGAN 网络形成，我们训练它执行 `从干净图像到其被污染的对应图像` 的图像到图像的转换。CycleGAN 方法的主要问题是它修改了整个图像。对于我们期望的应用，这可能会在生成的图像中产生不希望的伪影。除此之外，生成的合成污染模式通常相对逼真。

接下来，我们使用污染的弱多边形annotation训练一个污染语义分割网络 M。      
基于弱多边形annotation WoodScape 数据集   
![3](3.png)    

尽管annotation相当粗糙，但分割网络 M 能够更精确地适应污染模式。     
![4](4.png)    

我们使用 WoodScape 数据集来训练污染分割网络。我们训练了一个超分辨率网络 U，我们用它将 GAN 生成的图像转换为原始图像分辨率（即，上采样的 4× 因子）。       
![5](5.png)    

我们取将干净图像转换为污染图像的生成器（GC2S）并将其应用于干净图像 I。它给我们一个带有随机污染模式的图像 Is。接下来，我们获得污染掩码 m。这是通过在生成的污染图像上应用语义分割网络，然后应用高斯平滑滤波器实现的：m = (M(Is))。结果的污染掩码 m 是一个值在 [0, 1] 范围内的图像，其中 0 表示背景，1 表示污染。中间值可以被理解为半透明的污染。我们应用高斯平滑滤波器，因为它模拟了污染现象的物理性质，其中污染模式的边缘通常是半透明的，这是由于光子散射。最后，原始图像的人工污染版本 ˆI 是原始图像 I 和污染模式 Is 通过估计的掩码 m 的组合：  
```
I = (1 − U (m)) · I + U (m) · U(Is) 
```

总之，判别器在DirtyGAN中起到了关键作用，帮助生成器生成更逼真的看似被污染的图像。   
DirtyGAN 是一个创新性的方法，通过生成看似被污染的图像来改善自动驾驶中相机镜头污染检测的性能。   

